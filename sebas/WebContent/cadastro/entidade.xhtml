<ui:composition template="/template/template.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">
	<ui:define name="corpo">
		<h:form
			rendered="#{entidadeMB.utilController.statusListing and entidadeMB.permissao.acesso == 's'}">
			<p:panel header="Entidade">
				<p:commandButton ajax="false" icon="ui-icon-document"
					value="#{texto.botao_novo_registro}"
					title="#{texto.botao_novo_registro_desc}"
					action="#{entidadeMB.criar()}"
					rendered="#{entidadeMB.permissao.inclusao == 's'}" />
				<br />
				<br />

				<p:dataTable id="tabelaEntidade"
					value="#{entidadeMB.listaEntidades}" paginator="true" var="item"
					filterEvent="enter"
					rows="#{texto.quantidade_itens_padrao_listagem}"
					paginatorTemplate="#{texto.paginatorTemplate}"
					rowsPerPageTemplate="#{texto.rowsPerPageTemplate}"
					paginatorPosition="#{texto.paginatorPosition}"
					emptyMessage="#{texto.nenhum_registro_encontrado}">

					<p:column headerText="Nome fantasia"
						filterBy="#{item.nomeFantasia}" sortBy="#{item.nomeFantasia}"
						filterMatchMode="contains">
						<h:outputText value="#{item.nomeFantasia}" />
					</p:column>
					<p:column headerText="CNPJ" filterBy="#{item.cnpj}"
						sortBy="#{item.cnpj}" filterMatchMode="contains">
						<h:outputText value="#{item.cnpj}" />
					</p:column>
					<p:column headerText="Data abertura"
						filterBy="#{item.dataAbertura}" sortBy="#{item.dataAbertura}"
						filterMatchMode="contains">
						<h:outputText value="#{item.dataAbertura.time}">
							<f:convertDateTime pattern="dd/MM/yyyy" />
						</h:outputText>
					</p:column>

					<p:column styleClass="tamanhoCampoAcoesTabela"
						headerText="#{texto.texto_para_coluna_acoes}">
						<p:commandLink ajax="false" title="#{texto.acao_editar_registro}"
							rendered="#{entidadeMB.permissao.alteracao == 's'}"
							action="#{entidadeMB.editar()}">
							<h:graphicImage value="/resources/imagens/icons/edit.png" />
							<f:setPropertyActionListener target="#{entidadeMB.entidade}"
								value="#{item}" />
						</p:commandLink>
						<p:spacer width="10px" />
						<p:commandLink ajax="false" update="formLista"
							rendered="#{entidadeMB.permissao.exclusao == 's'}"
							title="#{texto.acao_desativar_registro}"
							action="#{entidadeMB.preparaParaDesativar()}">
							<h:graphicImage value="/resources/imagens/icons/remover.png" />
							<f:setPropertyActionListener target="#{entidadeMB.entidade}"
								value="#{item}" />
						</p:commandLink>
					</p:column>
				</p:dataTable>
			</p:panel>
		</h:form>

		<h:form id="formCadastro" 
			rendered="#{!entidadeMB.utilController.statusListing and !entidadeMB.utilController.statusFiltering}"
			binding="#{entidadeMB.form}">
			<p:panel header="Cadastro de Entidade">
				<p:fieldset legend="Dados da Entidade">
					<h:panelGrid columns="2" id="panel" columnClasses="tamanho100">
						<h:outputLabel value="Nome empresarial:" />
						<p:inputText id="nomeEmpresarial" styleClass="maxCampoTexto"
							value="#{entidadeMB.entidade.nomeEmpresarial}" />

						<h:outputLabel value="Nome fantasia:" />
						<p:inputText id="nomeFantasia" styleClass="maxCampoTexto"
							value="#{entidadeMB.entidade.nomeFantasia}" />

						<h:outputLabel value="CNPJ:" />
						<p:inputMask id="cnpj" value="#{entidadeMB.entidade.cnpj}"
							mask="99.999.999/9999-99" styleClass="maxCampoCNPJ" />

						<h:outputLabel value="Data de abertura:" />
						<p:calendar id="dataAbertura"
							value="#{entidadeMB.entidade.dataAbertura.time}"
							pattern="dd/MM/yyyy" mask="true" styleClass="maxCampoTexto" />

						<h:outputLabel value="Data de fundação:" />
						<p:calendar id="dataFundacao"
							value="#{entidadeMB.entidade.dataFundacao.time}"
							pattern="dd/MM/yyyy" mask="true" styleClass="maxCampoTexto" />

						<h:outputLabel value="Logradouro:" />
						<h:panelGrid columns="2">
							<p:inputText id="logradouro" styleClass="maxCampoTexto"
								value="#{entidadeMB.entidade.endereco.logradouro}" />
							<p:inputText id="numero" styleClass="maxCampoNumeroP"
								value="#{entidadeMB.entidade.endereco.numero}" placeholder="Nº" />
						</h:panelGrid>

						<h:outputLabel value="Complemento:" />
						<p:inputText id="complemento" styleClass="maxCampoTexto"
							value="#{entidadeMB.entidade.endereco.complemento}" />

						<h:outputLabel value="Cep:" />
						<p:inputMask id="cep" value="#{entidadeMB.entidade.endereco.cep}"
							mask="99.999-999" styleClass="maxCampoTexto" />

						<h:outputLabel value="Bairro:" />
						<p:inputText id="bairro" styleClass="maxCampoTexto"
							value="#{entidadeMB.entidade.endereco.bairro}" />

						<h:outputLabel value="UF:" />
						<h:panelGrid columns="2">
							<p:selectOneMenu id="estado" value="#{entidadeMB.estado}"
								filter="true" filterMatchMode="contains"
								styleClass="maxCampoTexto">
								<f:selectItem itemLabel="Selecione" />
								<f:selectItems value="#{entidadeMB.listaEstados}" var="estado"
									itemLabel="#{estado.nome}" itemValue="#{estado}" />
								<p:ajax update="cidade" />
							</p:selectOneMenu>
							<p:selectOneMenu id="cidade"
								value="#{entidadeMB.entidade.endereco.cidade}" filter="true"
								filterMatchMode="contains" styleClass="maxCampoTexto">
								<f:selectItem itemLabel="Cidade" />
								<f:selectItems value="#{entidadeMB.estado.cidades}" var="cidade"
									itemLabel="#{cidade.nome}" itemValue="#{cidade}" />
							</p:selectOneMenu>
						</h:panelGrid>
					</h:panelGrid>
					<br />
					<h:panelGrid columns="1">
						<h:outputLabel
							value="Código e descrição da atividade e econômica principal (CNAE):" />
						<p:selectOneMenu id="atividadeEconomica"
							value="#{entidadeMB.entidade.atividadeEconomica}" filter="true"
							filterMatchMode="contains">
							<f:selectItem itemLabel="Selecione a atividade econômica" />
							<f:selectItems value="#{entidadeMB.listaAtividadeEconomicas}"
								var="ae"
								itemLabel="#{ae.codigoAtividade} - #{ae.descricaoAtividade}"
								itemValue="#{ae}" />
						</p:selectOneMenu>
					</h:panelGrid>

					<p:commandButton value="Adicionar contato"
						oncomplete="PF('dialogContato').show();" />
					<br />
					<p:dataTable id="tabelaContato"
						value="#{entidadeMB.entidade.contatos}" var="contato"
						emptyMessage="#{texto.nenhum_registro_encontrado}">
						<p:column headerText="Tipo do contato">
							<h:outputText value="#{contato.tipoContato.nome}" />
						</p:column>
						<p:column headerText="Descrição">
							<h:outputText value="#{contato.nome}" />
						</p:column>
					</p:dataTable>
				</p:fieldset>
				<br />
				<br />
				<p:fieldset legend="Dados do Presidente">
					<h:panelGrid columns="2" columnClasses="tamanho100">
						<h:outputLabel value="Nome:" />
						<p:inputText value="#{entidadeMB.entidade.presidente.nome}" />

						<h:outputLabel value="Data de nascimento:" />
						<p:calendar id="dataNascimento"
							value="#{entidadeMB.entidade.presidente.nascimento.time}"
							pattern="dd/MM/yyyy" mask="true" />

						<h:outputLabel value="CPF:" />
						<p:inputMask id="cpf"
							value="#{entidadeMB.entidade.presidente.cpf}"
							mask="999.999.999-99" />

						<h:outputLabel value="Número RG:" />
						<p:inputText id="rg" value="#{entidadeMB.entidade.presidente.rg}" />

						<h:outputLabel value="Órgão expedidor/UF:" />
						<p:inputText id="orgaoExpedidor"
							value="#{entidadeMB.entidade.presidente.orgaoExpeditor}" />

						<h:outputLabel value="Mandato da diretoria:" />
						<h:panelGrid columns="2">
							<p:calendar id="inicioMandato"
								value="#{entidadeMB.entidade.presidente.inicioMandato.time}"
								pattern="dd/MM/yyyy" mask="true" placeholder="Início" />
							<p:calendar id="fimMandato"
								value="#{entidadeMB.entidade.presidente.fimMandato.time}"
								pattern="dd/MM/yyyy" mask="true" placeholder="Fim" />
						</h:panelGrid>

						<h:outputLabel value="E-mail:" />
						<p:inputText id="email"
							value="#{entidadeMB.entidade.presidente.email}" />

						<h:outputLabel value="Telefone:" />
						<p:inputText id="telefone"
							value="#{entidadeMB.entidade.presidente.telefone}" />
					</h:panelGrid>
				</p:fieldset>
				<br />
				<br />
				<p:fieldset legend="Anexos">
					<p:commandButton value="Anexar arquivo" oncomplete="PF('dialogAnexo').show();" action="#{entidadeMB.criarDocumento()}"/>

					<p:dataTable id="tabelaDocumento"
						value="#{entidadeMB.entidade.documentoNecessarios}" var="doc"
						emptyMessage="Nenhum documento anexado">
						<p:column headerText="Tipo do documento">
							<h:outputText value="#{doc.tipoDocumento.nome}" />
						</p:column>
					</p:dataTable>
				</p:fieldset>

				<h:outputText value="#{texto.campos_obrigatorios}" escape="false" />

				<p:commandButton ajax="false" icon="ui-icon-disk"
					value="#{texto.botao_salvar_registro}"
					title="#{texto.botao_salvar_registro_desc}"
					action="#{entidadeMB.salvar()}"
					rendered="#{entidadeMB.utilController.statusInserting || entidadeMB.utilController.statusEditing}" />
				<p:spacer height="5px" />
				<p:commandButton ajax="false" icon="ui-icon-trash"
					value="#{texto.botao_desativar_registro}"
					title="#{texto.botao_desativar_registro_desc}"
					action="#{entidadeMB.desativar()}"
					rendered="#{entidadeMB.utilController.statusRemoving}" />
				<p:spacer height="5px" />
				<p:commandButton ajax="false" icon="ui-icon-closethick"
					value="#{texto.botao_voltar}" title="#{texto.botao_voltar_desc}"
					action="#{entidadeMB.voltarLista()}" immediate="true" />
			</p:panel>
		</h:form>

		<h:form id="formContato">
			<p:dialog id="dialContato" widgetVar="dialogContato" modal="true"
				resizable="false">
				<ui:include src="/cadastro/partials/contato.xhtml" />
				<br />
				<p:commandButton value="Adicionar"
					action="#{entidadeMB.adicionaContato()}"
					oncomplete="PF('dialogContato').hide();"
					update=":formCadastro:tabelaContato :formContato:panelCadastro"
					process="@this, panelCadastro" />
			</p:dialog>
		</h:form>

		<h:form id="formAnexo" enctype="multipart/form-data">
			<p:dialog id="dialAnexo" widgetVar="dialogAnexo" modal="true" resizable="false">
				<h:panelGrid id="panelDocumento" columns="2" columnClasses="tamanho100">
					<h:outputLabel value="Tipo do documento:" />
					<p:selectOneMenu id="tipoDocumento"
						value="#{entidadeMB.documentoNecessario.tipoDocumento}">
						<f:selectItem itemLabel="Selecione" />
						<f:selectItems value="#{entidadeMB.listaTipoDocumentos}"
							var="tipo" itemLabel="#{tipo.nome}" itemValue="#{tipo}" />
					</p:selectOneMenu>

					<h:outputLabel value="Documento:" />
					<p:fileUpload id="caminho" value="#{entidadeMB.file}" fileUploadListener="#{entidadeMB.handleFileUpload}" mode="advanced" />
				</h:panelGrid>
				<p:commandButton value="Adicionar" oncomplete="PF('dialogAnexo').hide();"
					action="#{entidadeMB.adicionaDocumento()}" immediate="true"
					process=":formAnexo, :formAnexo:caminho" />
			</p:dialog>
		</h:form>
	</ui:define>
</ui:composition>